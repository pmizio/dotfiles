---
- name: Set variables
  ansible.builtin.set_fact:
    HOME: "{{ lookup('env','HOME') }}"
    CARGO_PATH: "{{ lookup('env','HOME') }}/.cargo/bin:{{ ansible_env.PATH }}"
- name: Install packages using apt
  become: true
  ansible.builtin.apt:
    pkg:
      - curl
      - build-essential
      - fish
      - git
      - fzf
      - ripgrep
      - zoxide
      - bat
      - jq
      - tmux
- name: Download rust installation script
  get_url:
    url: https://sh.rustup.rs
    dest: "{{ HOME }}"
    mode: a+x
- name:  Install rust toolchain
  command: "{{ HOME }}/rustup-init.sh -y"
- name: Delete rust installation script
  ansible.builtin.file:
    path: "{{ HOME }}/rustup-init.sh"
    state: absent
- name: Install packages from cargo
  ansible.builtin.shell: |
    cargo install fnm exa
  environment:
    PATH: "{{ CARGO_PATH }}"
- name: Install starship prompt
  ansible.builtin.shell: |
    curl -sS https://starship.rs/install.sh | sh -s -- -y
  environment:
    PATH: "{{ CARGO_PATH }}"
